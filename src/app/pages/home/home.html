<section class="page-grid">
  <p class="error-message" *ngIf="errorMessage()">{{ errorMessage() }}</p>

  <div class="month-switcher">
    <button type="button" (click)="changeMonth(-1)" aria-label="Предыдущий месяц">‹</button>
    <span class="month-label">Текущий месяц: {{ monthLabel }}</span>
    <button type="button" (click)="changeMonth(1)" aria-label="Следующий месяц">›</button>
  </div>

  <div class="tables-grid">
    <section class="card">
      <div class="table-header">
        <h2>Расходы</h2>
        <span class="table-count">Всего: {{ expenses().length }}</span>
      </div>
      <table>
        <thead>
        <tr>
          <th>Дата</th>
          <th>Категория</th>
          <th>Кошелек</th>
          <th>Описание</th>
          <th>Сумма</th>
          <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        <tr class="entry-row">
          <td>
            <input type="date" [(ngModel)]="expenseDate" name="expenseDate" required/>
          </td>
          <td>
            <select [(ngModel)]="expenseCategoryId" name="expenseCategoryId" required>
              <option [ngValue]="null" disabled>Выберите категорию</option>
              <option *ngFor="let category of activeSpendCategories()" [ngValue]="category.id">
                {{ category.name }}
              </option>
            </select>
          </td>
          <td>
            <select [(ngModel)]="expenseWalletId" name="expenseWalletId" required>
              <option [ngValue]="null" disabled>Выберите кошелек</option>
              <option *ngFor="let wallet of activeWallets()" [ngValue]="wallet.id">
                {{ wallet.name }}
              </option>
            </select>
          </td>
          <td>
            <input
              type="text"
              [(ngModel)]="expenseDescription"
              name="expenseDescription"
              placeholder="Продукты"
              required
            />
          </td>
          <td>
            <div class="amount-cell">
              <input
                type="number"
                min="0"
                [(ngModel)]="expenseAmount"
                name="expenseAmount"
                placeholder="3500"
                required
              />

            </div>
          </td>
          <td>
            <button type="button" (click)="addExpense()">+</button>
          </td>
        </tr>
        <tr *ngFor="let expense of expenses()">
          <td>{{ expense.date }}</td>
          <td>{{ getSpendCategoryName(expense.spendCategoryId) }}</td>
          <td>{{ getWalletName(expense.walletId) }}</td>
          <td>{{ expense.description }}</td>
          <td>{{ expense.amount | number : '1.0-2' }}</td>
          <td>
            <button type="button" class="delete-button" (click)="deleteExpense(expense.id)">
              X
            </button>
          </td>
        </tr>
        <tr *ngIf="!expenses().length">
          <td colspan="6" class="empty-state">Расходы пока не добавлены.</td>
        </tr>
        </tbody>
      </table>
    </section>


    <section class="card">
      <div class="table-header">
        <h2>Доходы</h2>
        <span class="table-count">Всего: {{ incomes().length }}</span>
      </div>
      <table>
        <thead>
        <tr>
          <th>Дата</th>
          <th>Категория</th>
          <th>Кошелек</th>
          <th>Сумма</th>
          <th>Действия</th>
        </tr>
        </thead>
        <tbody>
        <tr class="entry-row">
          <td>
            <input type="date" [(ngModel)]="incomeDate" name="incomeDate" required/>
          </td>
          <td>
            <select [(ngModel)]="incomeCategoryId" name="incomeCategoryId" required>
              <option [ngValue]="null" disabled>Выберите категорию</option>
              <option *ngFor="let category of activeIncomeCategories()" [ngValue]="category.id">
                {{ category.name }}
              </option>
            </select>
          </td>
          <td>
            <select [(ngModel)]="incomeWalletId" name="incomeWalletId" required>
              <option [ngValue]="null" disabled>Выберите кошелек</option>
              <option *ngFor="let wallet of activeWallets()" [ngValue]="wallet.id">
                {{ wallet.name }}
              </option>
            </select>
          </td>

          <td>
            <div class="amount-cell">
              <input
                type="number"
                min="0"
                [(ngModel)]="incomeAmount"
                name="incomeAmount"
                placeholder="50000"
                required
              />
            </div>
          </td>
          <td>
            <button type="button" (click)="addIncome()">+</button>
          </td>
        </tr>
        <tr *ngFor="let income of incomes()">
          <td>{{ income.incomeDate }}</td>
          <td>{{ getIncomeCategoryName(income.incomeCategoryId) }}</td>
          <td>{{ getWalletName(income.walletId) }}</td>
          <td>{{ income.amount | number : '1.0-2' }}</td>
          <td>
            <button type="button" class="delete-button" (click)="deleteIncome(income.id)">
              X
            </button>
          </td>
        </tr>
        <tr *ngIf="!incomes().length">
          <td colspan="5" class="empty-state">Доходы пока не добавлены.</td>
        </tr>
        </tbody>
      </table>
    </section>


  </div>
</section>
